"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ChatUser = void 0;
var tslib_1 = require("tslib");
var cache_decorators_1 = require("@d-fischer/cache-decorators");
/**
 * A user in chat.
 */
var ChatUser = /** @class */ (function () {
    /** @private */
    function ChatUser(userName, userData) {
        this._userName = userName.toLowerCase();
        this._userData = userData ? new Map(userData) : new Map();
    }
    ChatUser.prototype._parseBadgesLike = function (badgesLikeStr) {
        if (!badgesLikeStr) {
            return new Map();
        }
        return new Map(badgesLikeStr.split(',').map(function (badge) { return badge.split('/', 2); }));
    };
    Object.defineProperty(ChatUser.prototype, "userName", {
        /**
         * The name of the user.
         */
        get: function () {
            return this._userName;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(ChatUser.prototype, "displayName", {
        /**
         * The display name of the user.
         */
        get: function () {
            var _a;
            return (_a = this._userData.get('display-name')) !== null && _a !== void 0 ? _a : this._userName;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(ChatUser.prototype, "color", {
        /**
         * The color the user chose to display in chat.
         *
         * Returns null if the user didn't choose a color. In this case, you should generate your own color.
         */
        get: function () {
            return this._userData.get('color');
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(ChatUser.prototype, "badges", {
        /**
         * The badges of the user. Returned as a map that maps the badge category to the detail.
         */
        get: function () {
            var badgesStr = this._userData.get('badges');
            return this._parseBadgesLike(badgesStr);
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(ChatUser.prototype, "badgeInfo", {
        /**
         * The badge info of the user. Returned as a map that maps the badge category to the detail.
         */
        get: function () {
            var badgeInfoStr = this._userData.get('badge-info');
            return this._parseBadgesLike(badgeInfoStr);
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(ChatUser.prototype, "userId", {
        /**
         * The ID of the user.
         */
        get: function () {
            return this._userData.get('user-id');
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(ChatUser.prototype, "userType", {
        /**
         * The type of the user.
         * Possible values are undefined, 'mod', 'global_mod', 'admin' and 'staff'.
         */
        get: function () {
            return this._userData.get('user-type');
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(ChatUser.prototype, "isBroadcaster", {
        /**
         * Whether the user is the broadcaster.
         */
        get: function () {
            return this.badges.has('broadcaster');
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(ChatUser.prototype, "isSubscriber", {
        /**
         * Whether the user is subscribed to the channel.
         */
        get: function () {
            return this.badges.has('subscriber') || this.isFounder;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(ChatUser.prototype, "isFounder", {
        /**
         * Whether the user is a Founder of the channel.
         */
        get: function () {
            return this.badges.has('founder');
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(ChatUser.prototype, "isMod", {
        /**
         * Whether the user is a moderator of the channel.
         */
        get: function () {
            return this.badges.has('moderator');
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(ChatUser.prototype, "isVip", {
        /**
         * Whether the user is a VIP in the channel.
         */
        get: function () {
            return this.badges.has('vip');
        },
        enumerable: false,
        configurable: true
    });
    tslib_1.__decorate([
        cache_decorators_1.CachedGetter()
    ], ChatUser.prototype, "badges", null);
    tslib_1.__decorate([
        cache_decorators_1.CachedGetter()
    ], ChatUser.prototype, "badgeInfo", null);
    ChatUser = tslib_1.__decorate([
        cache_decorators_1.Cacheable
    ], ChatUser);
    return ChatUser;
}());
exports.ChatUser = ChatUser;
