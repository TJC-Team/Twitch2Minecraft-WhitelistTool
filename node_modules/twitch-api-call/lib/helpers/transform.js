"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.transformTwitchApiResponse = void 0;
var tslib_1 = require("tslib");
var HttpStatusCodeError_1 = require("../errors/HttpStatusCodeError");
/** @private */
function transformTwitchApiResponse(response) {
    return tslib_1.__awaiter(this, void 0, void 0, function () {
        var _a, _b, text;
        return tslib_1.__generator(this, function (_c) {
            switch (_c.label) {
                case 0:
                    if (!!response.ok) return [3 /*break*/, 2];
                    _a = HttpStatusCodeError_1.HttpStatusCodeError.bind;
                    _b = [void 0, response.status, response.statusText];
                    return [4 /*yield*/, response.json()];
                case 1: throw new (_a.apply(HttpStatusCodeError_1.HttpStatusCodeError, _b.concat([_c.sent()])))();
                case 2:
                    if (response.status === 204) {
                        // eslint-disable-next-line @typescript-eslint/no-explicit-any
                        return [2 /*return*/, undefined]; // oof
                    }
                    return [4 /*yield*/, response.text()];
                case 3:
                    text = _c.sent();
                    if (!text) {
                        // eslint-disable-next-line @typescript-eslint/no-explicit-any
                        return [2 /*return*/, undefined]; // mega oof - twitch doesn't return a response when it should
                    }
                    return [2 /*return*/, JSON.parse(text)];
            }
        });
    });
}
exports.transformTwitchApiResponse = transformTwitchApiResponse;
